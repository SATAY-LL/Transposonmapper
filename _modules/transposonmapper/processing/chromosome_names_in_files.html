
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>transposonmapper.processing.chromosome_names_in_files &#8212; SATAY pipeline at Delft :)</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <link rel="shortcut icon" href="../../../_static/genetica_modified_neon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/genetica_modified_neon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SATAY pipeline at Delft :)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Introduction.html">
   Status of the project
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../03-docker-doc/00-Docker-Intro.html">
   SATAY pipeline
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../03-docker-doc/01-Docker-Setup.html">
     Setting up docker
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../03-docker-doc/02-Docker-adapters.html">
     Creating a custom
     <em>
      adapters.fa
     </em>
     file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../03-docker-doc/03-Docker-Developers.html">
     Building the Docker image
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../getting-started/00-getting-started.html">
   Installing transposonmapper
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../06-Tutorials/00-name.html">
   Tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../06-Tutorials/tutorial.html">
     Transposonmapper output data postprocessing
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  About SATAY
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../00-Intro/what_is_satay.html">
   What is SATAY
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../00-Intro/experimental_setup.html">
     SATAY Experimental Process
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../00-Intro/gene_essentiality.html">
     Gene Essentiality in budding yeast
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../00-Intro/research-context-behind-satay.html">
     Research questions behind the use of SATAY
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  About Transposonmapper
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../00-Intro/flowchart.html">
   What is Transposonmapper
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../00-Intro/software-detailed-description-satay.sh.html">
     Overview of the software required for satay.sh
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../00-Intro/satay.sh-detailed-description-file-types.html">
     Detailed description of the output files from satay.sh
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../00-Intro/interpreting_insertions_reads.html">
     Interpreting Transposon Counts &amp; Reads
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Community
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../04-Developers/00-contributing-guidelines.html">
   Contributing guidelines for developers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../05-Code-of-conduct/00-code-of-conduct.html">
   Code of Conduct
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  API reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../api/api.html">
   Transposonmapper
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../api/api_exporting.html">
     transposonmapper.exporting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../api/api_importing.html">
     transposonmapper.importing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../api/api_mapping.html">
     transposonmapper.mapping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../api/api_plotting.html">
     transposonmapper.plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../api/api_processing.html">
     transposonmapper.processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../api/api_properties.html">
     transposonmapper.properties
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../api/api_statistics.html">
     transposonmapper.statistics
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/SATAY-LL/Transposonmapper"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/SATAY-LL/Transposonmapper/issues/new?title=Issue%20on%20page%20%2F_modules/transposonmapper/processing/chromosome_names_in_files.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <h1>Source code for transposonmapper.processing.chromosome_names_in_files</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<div class="viewcode-block" id="chromosome_name_bedfile"><a class="viewcode-back" href="../../../api/api_processing.html#transposonmapper.processing.chromosome_name_bedfile">[docs]</a><span class="k">def</span> <span class="nf">chromosome_name_bedfile</span><span class="p">(</span><span class="n">bed_file</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;This function returns some properties of the chromosomes in a bed file.</span>
<span class="sd">    Input can be either of two options:</span>
<span class="sd">        The full path to a bed file after which the program opens the bed file, or</span>
<span class="sd">        a list of the lines in the bed file. The latter requires to read the bed file before calling this function and input all lines in the bed file as a list. The function than does not open the bed file again.</span>
<span class="sd">    Returns three dictionaries (in this order):</span>
<span class="sd">        The first indicates the names of the chromosomes as used in the bed file (keys are roman numerals 1 to 16 and the values are the names used in the bed file).</span>
<span class="sd">        The second is the start line in the bed file of each chromosome (keys are the roman numerals of the chromosome names and the values are the start lines in the bed file of the chromosome).</span>
<span class="sd">        The third is the end line in the bed file of each chromosome (keys are the roman numerals of the chromosome names and the values are the start lines in the bed file of the chromosome)</span>

<span class="sd">    CHANGE LINE 60 AND 71 TO AUTOMATICALLY RECOGNIZE THE MITOCHONDRIAL DNA NAME</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">bed_file</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">bed_file</span><span class="p">),</span> <span class="s2">&quot;ERROR: bed file not found&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">bed_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">bed_file</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">bed_file</span>




    <span class="n">num_arabic</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">]</span>
    <span class="n">num_roman</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;II&#39;</span><span class="p">,</span><span class="s1">&#39;III&#39;</span><span class="p">,</span><span class="s1">&#39;IV&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;VI&#39;</span><span class="p">,</span><span class="s1">&#39;VII&#39;</span><span class="p">,</span><span class="s1">&#39;VIII&#39;</span><span class="p">,</span><span class="s1">&#39;IX&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;XI&#39;</span><span class="p">,</span><span class="s1">&#39;XII&#39;</span><span class="p">,</span><span class="s1">&#39;XIII&#39;</span><span class="p">,</span><span class="s1">&#39;XIV&#39;</span><span class="p">,</span><span class="s1">&#39;XV&#39;</span><span class="p">,</span><span class="s1">&#39;XVI&#39;</span><span class="p">]</span>
    <span class="n">roman_to_arabic_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">index_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">rom</span> <span class="ow">in</span> <span class="n">num_roman</span><span class="p">:</span>
        <span class="n">roman_to_arabic_dict</span><span class="p">[</span><span class="n">rom</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_arabic</span><span class="p">[</span><span class="n">index_counter</span><span class="p">]</span>
        <span class="n">index_counter</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">chromosome_romannames_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">roman</span> <span class="ow">in</span> <span class="n">roman_to_arabic_dict</span><span class="p">:</span>
        <span class="n">chromosome_romannames_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roman</span><span class="p">)</span>




    <span class="n">chrom_names_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">chrom_start_line_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">chrom_end_line_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">chrom_name_in_bed</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">chr_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">line_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">stop_loop</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">while</span> <span class="n">stop_loop</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">line_counter</span><span class="p">]</span>
        <span class="n">chrom_name_current</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">chrom_name_current</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;track&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">chrom_name_current</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">chrom_name_current</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ref|NC_001224|&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">chr_counter</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span> <span class="c1">#SKIP HEADER AND MITOCHRONDRIAL CHROMOSOMES #and not chrom_name_current.startswith(&#39;M&#39;)</span>
            <span class="k">if</span> <span class="n">chrom_name_current</span> <span class="o">!=</span> <span class="n">chrom_name_in_bed</span><span class="p">:</span>
                <span class="n">chrom_names_dict</span><span class="p">[</span><span class="n">chromosome_romannames_list</span><span class="p">[</span><span class="n">chr_counter</span><span class="p">]]</span> <span class="o">=</span> <span class="n">chrom_name_current</span>
                <span class="n">chrom_name_in_bed</span> <span class="o">=</span> <span class="n">chrom_name_current</span>
<span class="c1">#                print(&#39;Chromosome &#39;,chromosome_romannames_list[chr_counter], &#39;is &#39;,chrom_name_current)</span>
                
                <span class="n">chrom_start_line_dict</span><span class="p">[</span><span class="n">chromosome_romannames_list</span><span class="p">[</span><span class="n">chr_counter</span><span class="p">]]</span> <span class="o">=</span> <span class="n">line_counter</span> <span class="c1">#GET START INDEX IN THE BED FILE OF THE CURENT CHROMOSOME</span>
                <span class="k">if</span> <span class="n">chr_counter</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">chrom_end_line_dict</span><span class="p">[</span><span class="n">chromosome_romannames_list</span><span class="p">[</span><span class="n">chr_counter</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">line_counter</span><span class="o">-</span><span class="mi">1</span> <span class="c1">#GET THE END INDEX IN THE BED OF THE PREVIOUS CHROMOSOME (SKIP FOR THE FIRST CHROMOSOME)</span>

                <span class="n">chr_counter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">elif</span> <span class="n">chrom_name_current</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">chrom_name_current</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ref|NC_001224|&#39;</span><span class="p">):</span>
            <span class="n">chrom_end_line_dict</span><span class="p">[</span><span class="n">chromosome_romannames_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">line_counter</span><span class="o">-</span><span class="mi">1</span> <span class="c1">#GET THE END INDEX IN THE BED FILE FOR THE FINAL CHROMOSOME</span>
            <span class="n">stop_loop</span> <span class="o">=</span> <span class="kc">True</span>
                
        <span class="n">line_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        
    <span class="k">return</span><span class="p">(</span><span class="n">chrom_names_dict</span><span class="p">,</span> <span class="n">chrom_start_line_dict</span><span class="p">,</span> <span class="n">chrom_end_line_dict</span><span class="p">)</span></div>

<span class="c1">#%%</span>
<span class="k">def</span> <span class="nf">chromosome_name_wigfile</span><span class="p">(</span><span class="n">wig_file</span><span class="p">):</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">wig_file</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
      
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">wig_file</span><span class="p">),</span> <span class="s2">&quot;ERROR: wig file not found&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">wig_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">wig_file</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">wig_file</span>




    <span class="n">num_arabic</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">]</span>
    <span class="n">num_roman</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;II&#39;</span><span class="p">,</span><span class="s1">&#39;III&#39;</span><span class="p">,</span><span class="s1">&#39;IV&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;VI&#39;</span><span class="p">,</span><span class="s1">&#39;VII&#39;</span><span class="p">,</span><span class="s1">&#39;VIII&#39;</span><span class="p">,</span><span class="s1">&#39;IX&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;XI&#39;</span><span class="p">,</span><span class="s1">&#39;XII&#39;</span><span class="p">,</span><span class="s1">&#39;XIII&#39;</span><span class="p">,</span><span class="s1">&#39;XIV&#39;</span><span class="p">,</span><span class="s1">&#39;XV&#39;</span><span class="p">,</span><span class="s1">&#39;XVI&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">]</span>
    <span class="n">roman_to_arabic_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">index_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">rom</span> <span class="ow">in</span> <span class="n">num_roman</span><span class="p">:</span>
        <span class="n">roman_to_arabic_dict</span><span class="p">[</span><span class="n">rom</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_arabic</span><span class="p">[</span><span class="n">index_counter</span><span class="p">]</span>
        <span class="n">index_counter</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">chromosome_romannames_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">roman</span> <span class="ow">in</span> <span class="n">roman_to_arabic_dict</span><span class="p">:</span>
        <span class="n">chromosome_romannames_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roman</span><span class="p">)</span>





    <span class="n">chrom_names_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">chrom_start_line_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">chrom_end_line_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">chr_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">line_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">chrom_line</span> <span class="o">=</span> <span class="s1">&#39;variablestep&#39;</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">line_split</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">line_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">chrom_line</span> <span class="ow">and</span> <span class="n">chr_counter</span> <span class="o">&lt;</span> <span class="mi">17</span><span class="p">:</span>
            <span class="n">chromosome_name</span> <span class="o">=</span> <span class="n">line_split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;chrom=chr&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">chrom_names_dict</span><span class="p">[</span><span class="n">chromosome_romannames_list</span><span class="p">[</span><span class="n">chr_counter</span><span class="p">]]</span> <span class="o">=</span> <span class="n">chromosome_name</span>
<span class="c1">#            print(&#39;Chromosome &#39;,chromosome_romannames_list[chr_counter], &#39;is &#39;,chromosome_name)</span>
            
            <span class="n">chrom_start_line_dict</span><span class="p">[</span><span class="n">chromosome_romannames_list</span><span class="p">[</span><span class="n">chr_counter</span><span class="p">]]</span> <span class="o">=</span> <span class="n">line_counter</span><span class="o">+</span><span class="mi">1</span> <span class="c1">#GET START INDEX IN THE BED FILE OF THE CURENT CHROMOSOME</span>
            <span class="k">if</span> <span class="n">chr_counter</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">chrom_end_line_dict</span><span class="p">[</span><span class="n">chromosome_romannames_list</span><span class="p">[</span><span class="n">chr_counter</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">line_counter</span> <span class="c1">#GET THE END INDEX IN THE BED OF THE PREVIOUS CHROMOSOME (SKIP FOR THE FIRST CHROMOSOME)</span>

            <span class="n">chr_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">line_counter</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">chrom_end_line_dict</span><span class="p">[</span><span class="n">chromosome_romannames_list</span><span class="p">[</span><span class="n">chr_counter</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>


    <span class="k">return</span><span class="p">(</span><span class="n">chrom_names_dict</span><span class="p">,</span> <span class="n">chrom_start_line_dict</span><span class="p">,</span> <span class="n">chrom_end_line_dict</span><span class="p">)</span>

<span class="c1"># #%%</span>
<span class="c1"># if __name__ == &#39;__main__&#39;:</span>
<span class="c1">#     chrom_names_dict, chrom_start_line_dict, chrom_end_line_dict = chromosome_name_bedfile(bed_file=r&quot;&quot;)</span>
<span class="c1">#     # chrom_names_dict, chrom_start_line_dict, chrom_end_line_dict = chromosome_name_wigfile(wig_file=r&quot;&quot;)</span>
</pre></div>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Gregory van Beek , Maurits Kok, Leila IÃ±igo de la Cruz<br/>
        
            &copy; Copyright Apache 2.0.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>